# GPT генератор анекдотов

## Как запустить
1. (Опционально) Активируйте виртуальное окружение
    ```shell
    python3 -m venv venv && source venv/bin/activate
    ```
2. Установите зависимости
    ```shell
    pip3 install -r requirements.txt
    ```
3. Запустите
    ```shell
    python3 main.py
    ```
    Запуститься flask сайт с генерацией анекдотов.

## О модели
- Модель взята отсюда: https://github.com/karpathy/minGPT
    - версия *gpt-mini*
    - n_layer=6, n_head=6, n_embd=192
    - 3.46млн параметров
- Тренирована на CPU с нуля на коротких анекдотах отсюда: https://nekdo.ru/short/
- Токены - частотные буквосочетания.
    - У каждого буквосочетания длиной <= 10 считалась частотность `freq` (кол-во).
    - Рейтинг каждого буквосочетания:
    
        `grade = freq * (tkn_len ** 2)`

        Где  
        `freq` = сколько раз это сочетание попалось в датасете  
        `tkn_len` = длина буквосочетания
    - В конце в словарь токенов брались буквосочетания с самым высоким рейтингом.
 
# GPT генератор анекдотов

### Что умеет модель?

Бот присылает пользователю сгенерированный ею анекдот в ответ на запрос по конкретной теме.
<br /> Вот так выглядит реакция бота на запрос пользователя в окне диалога:
<br /> ![какой-то скрин](screenshot.png)

### Что под капотом?
1. Как-то откуда-то скачивается корпус анекдотов, на котором будет обучаться модель
2. Как-то учим модель работать
  <br /> 2.1 Сложности - ?
3. Создаём бот

### Что в каком файле лежит:
__anekdataset.py__ - 
<br /> __config.py__ - 
<br /> __generete.py__ - 
<br /> __lookup.py__ -
<br /> __tokenizer.py__ - 
<br /> __train.ipnb__ - 
<br /> __train.py__ - 

[___Сслыка на бот___]()
<br /> [___Ссылка на pythonanywhere___]()
